(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{711:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("日志就是记录程序的运行轨迹，方便查找关键信息，也方便快速定位解决问题。")]),t._v(" "),s("blockquote",[s("p",[t._v("谁不知道日志呀，下面我们看看世界上最好的语言 Java 的常用日志实现")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jul"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" trace "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log4j"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SLF4J"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Log")]),t._v(" log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLog")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Apache Commons Logging"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("我**，这么多，怎么记得住，我要用哪个？")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghjejmjjlhj3073073weh.jpg",alt:"img"}})]),t._v(" "),s("p",[t._v("项目中有一堆日志相关的 Jar 包，到底应该引入哪个排除哪个？")]),t._v(" "),s("p",[t._v("这两个 Jar 包冲突了?  这个包需要依赖这个包?")]),t._v(" "),s("p",[t._v("这类问题有时候容易让人崩溃，所以就来缕一缕 Java 日志框架的那点事~~")])]),t._v(" "),s("h2",{attrs:{id:"java常用日志框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java常用日志框架"}},[t._v("#")]),t._v(" Java常用日志框架")]),t._v(" "),s("ul",[s("li",[s("strong",[s("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/guides/logging/overview.html",title:"JUL",target:"_blank",rel:"noopener noreferrer"}},[t._v("JUL"),s("OutboundLink")],1)]),t._v(" (Java Util Logging) ：自 Java1.4 以来，Java 在 "),s("code",[t._v("Java.util.logging")]),t._v(" 中提供的一个内置框架，也常称为 JDKLog、jdk-logging")]),t._v(" "),s("li",[s("strong",[s("a",{attrs:{href:"https://logging.apache.org/log4j/2.x/",title:"log4j",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log4j"),s("OutboundLink")],1)]),t._v("：Apache Log4j 是一个基于 Java 的日志记录工具。最初是 Log4j 1，我们现在用的大都是 Log4j 2，Apache Log4j 2 是 Apache 开发的一款 Log4j 的升级产品，Log4j 2 与 Log4j 1 发生了很大的变化，Log4j 2 不兼容Log4j 1")]),t._v(" "),s("li",[s("strong",[s("a",{attrs:{href:"http://www.slf4j.org/",title:"SLF4J",target:"_blank",rel:"noopener noreferrer"}},[t._v("SLF4J"),s("OutboundLink")],1)]),t._v("："),s("code",[t._v("Simple Logging Facade for Java")]),t._v("，类似于 Commons Logging，是一套简易 Java 日志门面，本身并无日志的实现")]),t._v(" "),s("li",[s("strong",[s("a",{attrs:{href:"http://logback.qos.ch/",title:"Logback",target:"_blank",rel:"noopener noreferrer"}},[t._v("Logback"),s("OutboundLink")],1)]),t._v("：Logback 是 "),s("code",[t._v("Slf4j")]),t._v(" 的原生实现框架，同样也是出自 "),s("code",[t._v("Log4j")]),t._v(" 一个人之手，但拥有比 "),s("code",[t._v("log4j")]),t._v(" 更多的优点、特性和更做强的性能，现在基本都用来代替 "),s("code",[t._v("log4j")]),t._v(" 成为主流")]),t._v(" "),s("li",[s("strong",[s("a",{attrs:{href:"https://tinylog.org/v2/",title:"tinylog",target:"_blank",rel:"noopener noreferrer"}},[t._v("tinylog"),s("OutboundLink")],1)]),t._v("： 一个轻量级的开源日志框架")]),t._v(" "),s("li",[s("strong",[s("a",{attrs:{href:"http://commons.apache.org/proper/commons-logging/",title:"Apache Commons Logging",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Commons Logging"),s("OutboundLink")],1)]),t._v("：Apache 基金会所属的项目，是一套 Java 日志接口，之前叫 "),s("code",[t._v("Jakarta Commons Logging")]),t._v("，后更名为 Commons Logging")])]),t._v(" "),s("p",[t._v("JUL、log4j 、Logback 是"),s("strong",[t._v("日志实现框架")]),t._v("，而 Apache Commons Logging 和 SLF4J 是"),s("strong",[t._v("日志实现门面")]),t._v("，可以理解为一个适配器，"),s("strong",[t._v("可以将你的应用程序从日志框架中解耦")]),t._v("。")]),t._v(" "),s("blockquote",[s("p",[t._v("日志门面，是门面模式的一个典型的应用。")]),t._v(" "),s("p",[t._v("门面模式（Facade Pattern），也称之为外观模式，其核心为：外部与一个子系统的通信必须通过一个统一的外观对象进行，使得子系统更易于使用。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static01.imgkr.com/temp/34d51bca34e54c05a32d148439244496.png",alt:""}})])]),t._v(" "),s("blockquote",[s("p",[t._v("阿里巴巴 Java 开发手册嵩山版_日志规约：")]),t._v(" "),s("p",[t._v("【强制】应用中不可直接使用日志系统（Log4j、Logback）中的 API，而应依赖使用日志框架（SLF4J、JCL--Jakarta Commons Logging）中的 API，使用门面模式的日志框架，有利于维护和各个类的日志处理方式统一。")]),t._v(" "),s("p",[t._v("说明：日志框架（SLF4J、JCL--Jakarta Commons Logging）的使用方式（推荐使用 SLF4J）")]),t._v(" "),s("p",[t._v("使用 SLF4J：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("使用 JCL：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Log")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogFactory")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Log")]),t._v(" log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLog")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("到这里我好像就明白了，有 2 个日志接口标准和其他的几个具体实现，但还是要扯一扯，要不没人点赞~~")]),t._v(" "),s("h2",{attrs:{id:"java常用日志框架历史"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java常用日志框架历史"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://www.cnblogs.com/chenhongliang/p/5312517.html",title:"Java常用日志框架历史",target:"_blank",rel:"noopener noreferrer"}},[t._v("Java常用日志框架历史"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[s("p",[t._v("1996 年早期，欧洲安全电子市场项目组决定编写它自己的程序跟踪 API(Tracing API)。经过不断的完善，这个API 终于成为一个十分受欢迎的 Java 日志软件包，即 Log4j。后来 Log4j 成为 Apache 基金会项目中的一员。")])]),t._v(" "),s("li",[s("p",[t._v("2002 年 Java1.4 发布，Sun 推出了自己的日志库 JUL(Java Util Logging)，其实现基本模仿了 Log4j 的实现。在 JUL 出来以前，Log4j 就已经成为一项成熟的技术，使得 Log4j 在选择上占据了一定的优势。")]),t._v(" "),s("blockquote",[s("p",[t._v("谁能想到 Java1.4 之前，JDK 竟然没有内置的日志功能呢")])])]),t._v(" "),s("li",[s("p",[t._v("因为有了两种选择，所以导致了日志使用的混乱。所以 Apache 又推出了 "),s("code",[t._v("Jakarta Commons Logging")]),t._v("，JCL 只是定义了一套日志接口，支持运行时动态加载日志组件的实现，也就是说，应用层编写代码时，只需调用 JCL 提供的统一接口来记录日志，底层实现可以是 "),s("code",[t._v("Log4j")]),t._v("，也可以是 "),s("code",[t._v("Java Util Logging")]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("2006年，Log4j 的作者 Ceki Gülcü 从 Apache 离职，然后又搞出来一套类似 JCL 的接口类——Slf4j 和它的默认实现 Logback。")])]),t._v(" "),s("li",[s("p",[t._v("从此，Java 日志领域被划分为两大阵营：Commons Logging 阵营和 Slf4j 阵营。")])]),t._v(" "),s("li",[s("p",[t._v("2012 年，Apache 眼看有被 Logback 反超的势头，于是重写了 Log4j 1.x，成立了新的项目 Log4j 2，Log4j 2 具有 Logback 的所有特性。")])])]),t._v(" "),s("h2",{attrs:{id:"java-日志级别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-日志级别"}},[t._v("#")]),t._v(" Java 日志级别")]),t._v(" "),s("p",[t._v("不同的日志框架，级别也会有些差异")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("￼j.u.l：OFF、SEVERE、WARNING、INFO、CONFIG、FINE、FINER、FINEST、ALL")])]),t._v(" "),s("li",[s("p",[t._v("log4j：OFF、FATAL、ERROR、WARN、INFO、DEBUG、TRACE、 ALL")])]),t._v(" "),s("li",[s("p",[t._v("logback：OFF、ERROR、WARN、INFO、DEBUG、TRACE、 ALL")])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("日志级别")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("OFF")]),t._v(" "),s("td",[t._v("关闭：最高级别，不输出日志。")])]),t._v(" "),s("tr",[s("td",[t._v("FATAL")]),t._v(" "),s("td",[t._v("致命：输出非常严重的可能会导致应用程序终止的错误。")])]),t._v(" "),s("tr",[s("td",[t._v("ERROR")]),t._v(" "),s("td",[t._v("错误：输出错误，但应用还能继续运行。")])]),t._v(" "),s("tr",[s("td",[t._v("WARN")]),t._v(" "),s("td",[t._v("警告：输出可能潜在的危险状况。")])]),t._v(" "),s("tr",[s("td",[t._v("INFO")]),t._v(" "),s("td",[t._v("信息：输出应用运行过程的详细信息。")])]),t._v(" "),s("tr",[s("td",[t._v("DEBUG")]),t._v(" "),s("td",[t._v("调试：输出更细致的对调试应用有用的信息。")])]),t._v(" "),s("tr",[s("td",[t._v("TRACE")]),t._v(" "),s("td",[t._v("跟踪：输出更细致的程序运行轨迹。")])]),t._v(" "),s("tr",[s("td",[t._v("ALL")]),t._v(" "),s("td",[t._v("所有：输出所有级别信息。")])])])]),t._v(" "),s("h2",{attrs:{id:"commons-logging-与-slf4j-实现机制对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commons-logging-与-slf4j-实现机制对比"}},[t._v("#")]),t._v(" Commons Logging 与 Slf4j 实现机制对比")]),t._v(" "),s("h4",{attrs:{id:"commons-logging-实现机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commons-logging-实现机制"}},[t._v("#")]),t._v(" Commons Logging 实现机制")]),t._v(" "),s("p",[t._v("Commons Logging 是通过动态查找机制，在程序运行时，使用自己的 ClassLoader 寻找和载入本地具体的实现。详细策略可以查看 "),s("code",[t._v("commons-logging-*.jar")]),t._v(" 包中的"),s("code",[t._v("org.apache.commons.logging.impl.LogFactoryImpl.java")]),t._v(" 文件。由于 Osgi 不同的插件使用独立的ClassLoader，Osgi 的这种机制保证了插件互相独立，其机制限制了 Commons Logging 在 Osgi 中的正常使用。")]),t._v(" "),s("h4",{attrs:{id:"slf4j-实现机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#slf4j-实现机制"}},[t._v("#")]),t._v(" Slf4j 实现机制")]),t._v(" "),s("p",[t._v("Slf4j 在编译期间，静态绑定本地的 Log 库，因此可以在 Osgi 中正常使用。它是通过查找类路径下"),s("code",[t._v("org.slf4j.impl.StaticLoggerBinder")]),t._v("，然后在 StaticLoggerBinder 中进行绑定。")]),t._v(" "),s("h2",{attrs:{id:"项目中选择日志框架选择"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目中选择日志框架选择"}},[t._v("#")]),t._v(" 项目中选择日志框架选择")]),t._v(" "),s("p",[t._v("如果是在一个新的项目中建议使用 Slf4j 与 Logback 组合，这样有如下的几个优点")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Slf4j 实现机制决定 Slf4j 限制较少，使用范围更广。由于 Slf4j 在编译期间，静态绑定本地的 LOG 库使得通用性要比 Commons Logging 要好。")])]),t._v(" "),s("li",[s("p",[t._v("Logback 拥有更好的性能。Logback 声称：某些关键操作，比如判定是否记录一条日志语句的操作，其性能得到了显著的提高。这个操作在 Logback 中需要 3 纳秒，而在 Log4J 中则需要 30 纳秒。LogBack 创建记录器（logger）的速度也更快：13 毫秒，而在 Log4J 中需要 23 毫秒。更重要的是，它获取已存在的记录器只需94 纳秒，而 Log4J 需要 2234 纳秒，时间减少到了 1/23。跟 JUL 相比的性能提高也是显著的。")])]),t._v(" "),s("li",[s("p",[t._v("Commons Logging 开销更高")]),t._v(" "),s("p",[t._v("在使Commons Logging时为了减少构建日志信息的开销，通常的做法是")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDebugEnabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User name： "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n    user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" buy goods id ："')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" good"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("在 Slf4j 阵营，你只需这么做：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User name：{} ,buy goods id ：{}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("good"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("也就是说，Slf4j 把构建日志的开销放在了它确认需要显示这条日志之后，减少内存和 cup 的开销，使用占位符号，代码也更为简洁")])]),t._v(" "),s("li",[s("p",[t._v("Logback 文档免费。Logback 的所有文档是全面免费提供的，不像 Log4J 那样只提供部分免费文档而需要用户去购买付费文档。")])])]),t._v(" "),s("h2",{attrs:{id:"slf4j-绑定日志框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#slf4j-绑定日志框架"}},[t._v("#")]),t._v(" SLF4J 绑定日志框架")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghjfdb8016j31cy0riwhw.jpg",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"http://www.slf4j.org/images/concrete-bindings.png",alt:"来源：slf4j.org"}})]),t._v(" "),s("h2",{attrs:{id:"阿里java开发手册-日志规约"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阿里java开发手册-日志规约"}},[t._v("#")]),t._v(" 阿里Java开发手册——日志规约")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[t._v("【强制】日志文件至少保存 15 天，因为有些异常具备以“周”为频次发生的特点。")])]),t._v(" "),s("li",[s("p",[t._v("【强制】应用中的扩展日志（如打点、临时监控、访问日志等）命名方式： appName_logType_logName.log。 logType:日志类型，如 stats/monitor/access 等；logName:日志描述。这种命名的好处： 通过文件名就可知道日志文件属于什么应用，什么类型，什么目的，也有利于归类查找。 正例：mppserver 应用中单独监控时区转换异常，如： mppserver_monitor_timeZoneConvert.log 说明：推荐对日志进行分类，如将错误日志和业务日志分开存放，便于开发人员查看，也便于 通过日志对系统进行及时监控。")])]),t._v(" "),s("li",[s("p",[t._v('【强制】对 trace/debug/info 级别的日志输出，必须使用条件输出形式或者使用占位符的方 式。 说明：logger.debug("Processing trade with id: " + id + " and symbol: " + symbol); 如果日志级别是 warn，上述日志不会打印，但是会执行字符串拼接操作，如果 symbol 是对象， 会执行 toString()方法，浪费了系统资源，执行了上述操作，最终日志却没有打印。')]),t._v(" "),s("p",[t._v("正例：（条件）建设采用如下方式")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDebugEnabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Processing trade with id: "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" and symbol: "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" symbol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),s("p",[t._v("正例：（占位符）")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v(" logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Processing trade with id: {} and symbol : {} "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" symbol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])])]),t._v(" "),s("li",[s("p",[t._v("【强制】避免重复打印日志，浪费磁盘空间，务必在 log4j.xml 中设置 additivity=false。 正例：")])]),t._v(" "),s("li",[s("p",[t._v('【强制】异常信息应该包括两类信息：案发现场信息和异常堆栈信息。如果不处理，那么通过 关键字 throws 往上抛出。 正例：logger.error(各类参数或者对象 toString() + "_" + e.getMessage(), e);')])]),t._v(" "),s("li",[s("p",[t._v("【推荐】谨慎地记录日志。生产环境禁止输出 debug 日志；有选择地输出 info 日志；如果使 用 warn 来记录刚上线时的业务行为信息，一定要注意日志输出量的问题，避免把服务器磁盘 撑爆，并记得及时删除这些观察日志。 说明：大量地输出无效日志，不利于系统性能提升，也不利于快速定位错误点。记录日志时请 思考：这些日志真的有人看吗？看到这条日志你能做什么？能不能给问题排查带来好处？")])]),t._v(" "),s("li",[s("p",[t._v("【推荐】可以使用 warn 日志级别来记录用户输入参数错误的情况，避免用户投诉时，无所适 从。如非必要，请不要在此场景打出 error 级别，避免频繁报警。 说明：注意日志输出的级别，error 级别只记录系统逻辑出错、异常或者重要的错误信息。")])]),t._v(" "),s("li",[s("p",[t._v("【推荐】尽量用英文来描述日志错误信息，如果日志中的错误信息用英文描述不清楚的话使用 中文描述即可，否则容易产生歧义。国际化团队或海外部署的服务器由于字符集问题，【强制】 使用全英文来注释和描述日志错误信息。")])])]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://www.loggly.com/ultimate-guide/java-logging-basics/#layouts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ultimate Guide to Logging"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/chenhongliang/p/5312517.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Java常用日志框架介绍》"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("http://www.slf4j.org/manual.html")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/chenhongliang/p/5312517.html#java%E6%97%A5%E5%BF%97%E6%A6%82%E8%BF%B0",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/chenhongliang/p/5312517.html#java%E6%97%A5%E5%BF%97%E6%A6%82%E8%BF%B0"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);